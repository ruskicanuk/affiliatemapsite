<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test - Getting to Green Office</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f0f0f0;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-result {
            padding: 10px;
            margin: 5px 0;
            border-radius: 4px;
        }
        .pass {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .fail {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <h1>Flight Path Visualizer Test</h1>
    
    <div class="test-section">
        <h2>File Existence Tests</h2>
        <div id="file-tests"></div>
    </div>
    
    <div class="test-section">
        <h2>Data Loading Tests</h2>
        <div id="data-tests"></div>
    </div>
    
    <div class="test-section">
        <h2>Application Tests</h2>
        <div id="app-tests"></div>
        <button onclick="runAppTests()">Run Application Tests</button>
    </div>

    <script>
        // Test file existence
        async function testFileExists(filename) {
            try {
                const response = await fetch(filename);
                return response.ok;
            } catch (error) {
                return false;
            }
        }

        // Test data loading
        async function testDataLoading() {
            try {
                const response = await fetch('flights.jsonl');
                if (!response.ok) return false;
                
                const text = await response.text();
                const lines = text.trim().split('\n');
                const data = lines.map(line => JSON.parse(line));
                
                // Check if we have Dominican Republic destinations
                const drDestinations = data.filter(d => d.destination_country === 'Dominican Republic');
                return drDestinations.length >= 4;
            } catch (error) {
                return false;
            }
        }

        // Run file tests
        async function runFileTests() {
            const files = ['index.html', 'script.js', 'styles.css', 'flights.jsonl'];
            const container = document.getElementById('file-tests');
            
            for (const file of files) {
                const exists = await testFileExists(file);
                const div = document.createElement('div');
                div.className = `test-result ${exists ? 'pass' : 'fail'}`;
                div.textContent = `${file}: ${exists ? 'EXISTS' : 'MISSING'}`;
                container.appendChild(div);
            }
        }

        // Run data tests
        async function runDataTests() {
            const container = document.getElementById('data-tests');
            
            const dataLoaded = await testDataLoading();
            const div = document.createElement('div');
            div.className = `test-result ${dataLoaded ? 'pass' : 'fail'}`;
            div.textContent = `Flight data loading: ${dataLoaded ? 'SUCCESS' : 'FAILED'}`;
            container.appendChild(div);
        }

        // Run application tests
        function runAppTests() {
            const container = document.getElementById('app-tests');
            container.innerHTML = '';
            
            // Test if main application loads
            const iframe = document.createElement('iframe');
            iframe.src = 'index.html';
            iframe.style.width = '100%';
            iframe.style.height = '600px';
            iframe.style.border = '1px solid #ccc';
            iframe.style.borderRadius = '4px';
            
            iframe.onload = function() {
                const div = document.createElement('div');
                div.className = 'test-result pass';
                div.textContent = 'Application loaded successfully';
                container.insertBefore(div, iframe);
            };
            
            iframe.onerror = function() {
                const div = document.createElement('div');
                div.className = 'test-result fail';
                div.textContent = 'Application failed to load';
                container.insertBefore(div, iframe);
            };
            
            container.appendChild(iframe);
        }

        // Run tests on page load
        window.onload = function() {
            runFileTests();
            runDataTests();
        };
    </script>
</body>
</html>
